library(data.table)
library(arules)
library(arulesViz)
library(ggcharts)
library(dplyr)
library(tidyr)
library(ggplot2)


setwd("C:/Users/tyhen/Desktop/Analytics")
malware <- read.csv("Microsoft_Data_n50000.csv", header = TRUE, stringsAsFactors = FALSE)
summary(malware)

malware$Firewall[malware$Firewall=="1"] <- "Has Firewall"
malware$Firewall[malware$Firewall=="0"] <- "No Firewall"


malware$Census_IsTouchEnabled[malware$Census_IsTouchEnabled=="1"] <- "Is TouchEnabled"
malware$Census_IsTouchEnabled[malware$Census_IsTouchEnabled=="0"] <- "No TouchEnabled"

malware$Census_HasOpticalDiskDrive[malware$Census_HasOpticalDiskDrive=="1"] <- "Has OpticalDiskDrive"
malware$Census_HasOpticalDiskDrive[malware$Census_HasOpticalDiskDrive=="0"] <- "No OpticalDiskDrive"

malware$HasDetections[malware$HasDetections=="1"] <- "Has Malware"
malware$HasDetections[malware$HasDetections=="0"] <- "No Malware"


malware$Census_ProcessorCoreCount <- factor(malware$Census_ProcessorCoreCount)
malware$Processor <- factor(malware$Processor)
malware$Firewall <- factor(malware$Firewall)
malware$Census_HasOpticalDiskDrive <- factor(malware$Census_HasOpticalDiskDrive)
malware$Census_IsTouchEnabled <- factor(malware$Census_IsTouchEnabled)
malware$HasDetections <- factor(malware$HasDetections)
malware$Census_PrimaryDiskTypeName<-factor(malware$Census_PrimaryDiskTypeName)

summary(malware)
malware$X<-NULL


#Processor
count1 <- table(malware$HasDetections, malware$Processor)
prop1 <- prop.table(count1, margin=2) #hasMalware  0.5118838 0.3818466
par(mar=c(5.1, 4.1, 4.1, 7.1), xpd=TRUE)
barplot(prop1, main="Processor vs hasDeduction", xlab="Processor", ylab="Proportion", col = c("light blue", "grey"))
legend("topright",inset=c(-0.5,0.1), fill=c("light blue", "grey"), legend = rownames(count1), border = "grey", cex = 0.6)


#Census_ProcessorCoreCount
summary(malware$Census_ProcessorCoreCount)
count1 <- table(malware$HasDetections, malware$Census_ProcessorCoreCount)
prop1 <- prop.table(count1, margin=2)
par(mar=c(3.1, 3.1, 2.1, 4.1), xpd=TRUE)
barplot(prop1, main="Census_ProcessorCoreCount vs hasDeduction", xlab="Census_ProcessorCoreCount", ylab="Proportion", col = c("light blue", "grey"))
legend("topright",inset=c(-0.1,0), fill=c("light blue", "grey"), legend = rownames(count1), border = "grey", cex = 0.6)

#Firewall
summary(malware$Firewall)
count1 <- table(malware$HasDetections, malware$Firewall)
prop1 <- prop.table(count1, margin=2)
par(mar=c(3.1, 3.1, 2.1, 4.1), xpd=TRUE)
barplot(prop1, main="Firewall vs HasDetections", xlab="Firewall", ylab="Proportion", col = c("light blue", "grey"))
legend("topright",inset=c(-0.2,0), fill=c("light blue", "grey"), legend = rownames(count1), border = "grey", cex = 0.6)

#Census_PrimaryDiskTypeName
summary(malware$Census_PrimaryDiskTypeName)
count1 <- table(malware$HasDetections, malware$Census_PrimaryDiskTypeName)
prop1 <- prop.table(count1, margin=2)
par(mar=c(3.1, 3.1, 2.1, 4.1), xpd=TRUE)
barplot(prop1, main="Census_PrimaryDiskTypeName vs HasDetections", xlab="PrimaryDiskTypeName", ylab="Proportion", col = c("light blue", "grey"))
legend("topright",inset=c(-0.2,0), fill=c("light blue", "grey"), legend = rownames(count1), border = "grey", cex = 0.6)

#Census_SystemVolumeTotalCapacity

theme_set(theme_classic())
g <- ggplot(malware, aes(HasDetections, malware$Census_SystemVolumeTotalCapacity))
g + geom_boxplot(varwidth=T, fill="light blue") + 
  labs(title="Census_SystemVolumeTotalCapacity grouped by HasDeductions",
       x="HasDeductions",
       y="Census_SystemVolumeTotalCapacity")
options(scipen=10000)


#Census_HasOpticalDiskDrive
count1 <- table(malware$HasDetections, malware$Census_HasOpticalDiskDrive)
prop1 <- prop.table(count1, margin=2)
par(mar=c(3.1, 3.1, 2.1, 4.1), xpd=TRUE)
barplot(prop1, main="Census_HasOpticalDiskDrive vs HasDetections", xlab="Census_HasOpticalDiskDrive", ylab="Proportion", col = c("light blue", "grey"))
legend("topright",inset=c(-0.1,0), fill=c("light blue", "grey"), legend = rownames(count1), border = "grey", cex = 0.6, text.width = strwidth(rownames(count1))[1]*2)


#Census_TotalPhysicalRAM
theme_set(theme_classic())
g <- ggplot(malware, aes(HasDetections, Census_TotalPhysicalRAM))
g + geom_boxplot(varwidth=T, fill="light blue") + 
  labs(title="Census_TotalPhysicalRAM grouped by HasDetections",
       x="HasDetections",
       y="Census_TotalPhysicalRAM")+coord_flip()
options(scipen=10000)

#Census_InternalPrimaryDiagonalDisplaySizeInInches
theme_set(theme_classic())
g <- ggplot(malware, aes(HasDetections, Census_InternalPrimaryDiagonalDisplaySizeInInches))
g + geom_boxplot(varwidth=T, fill="light blue") + 
  labs(title="Census_InternalPrimaryDiagonalDisplaySizeInInches grouped by HasDetections",
       x="HasDetections",
       y="Census_InternalPrimaryDiagonalDisplaySizeInInches")+coord_flip()
options(scipen=10000)

#Census_IsTouchEnabled
count1 <- table(malware$HasDetections, malware$Census_IsTouchEnabled)
prop1 <- prop.table(count1, margin=2)
par(mar=c(3.1, 3.1, 2.1, 4.1), xpd=TRUE)
barplot(prop1, main="Census_IsTouchEnabled vs HasDetections", xlab="Census_IsTouchEnabled", ylab="Proportion", col = c("light blue", "grey"))
legend("topright",inset=c(-0.1,0), fill=c("light blue", "grey"), legend = rownames(count1), border = "grey", cex = 0.6,text.width = strwidth(rownames(count1))[1]*1.5)








